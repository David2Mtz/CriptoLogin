<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Google Places API</title>
</head>
<body>
  <h1>LUGARES DE LA API</h1>
  <div id="output"></div>
  
  <script>
    // Tu clave API de Google
    const API_KEY = "AIzaSyAY0wzQDOjgf_KCbiat_rDUzQi_g_v7A3s";
    //const placeId="ChIJw22Nzqv_0YURLscJNjBVnBw";
    const placesId=JSON.parse(localStorage.getItem('IdsLugares'));
    placesId.forEach((placeId) => {
      // URL base de la API
      const apiUrl = `https://places.googleapis.com/v1/places/${placeId}?fields=id,displayName,formattedAddress,plusCode,photos,location&key=${API_KEY}`;

      //url para mostrar fotos:
      //const apiUrlFotos = `https://places.googleapis.com/v1/places/ChIJkajXYzb_0YURT0Rtj5NgKeo/photos/AdDdOWqdpJjT9u_O0OIcY9KAnybhmZZawRy8GRGG6DwZOooOxBY51852L26yBq2gQ43GBBWtdfq4SbJ1DSO5PKvCT7-u2fxXdW6B86LLdQfwPnxuFXGNHI-6d_MqApWnNUm2ep_nspxTgQwvzspE8cafhfT185saoaQDyGBO/media?maxHeightPx=400&maxWidthPx=400&key=${API_KEY}`;

      const photoContainer = document.getElementById("output");
      //photoContainer.innerHTML = ""; // Limpiar contenedor
      // Consumir la API usando fetch
      fetch(apiUrl)
        .then(response => {
          if (!response.ok) {
            throw new Error(`Error en la solicitud: ${response.statusText}`);
          }
          return response.json();
        })
        .then(data => {
          console.log(data);
          const h2Title=document.createElement("h2");
          h2Title.textContent=data.displayName.text;
          const h3Title=document.createElement("h3");
          h3Title.textContent=data.formattedAddress;
          photoContainer.appendChild(h2Title);
          photoContainer.appendChild(h3Title);
          // Verificar si existe el atributo photos
          if (data.photos && Array.isArray(data.photos)) {
            
            // Iterar sobre el arreglo de fotos
            data.photos.forEach((photo, index) => {
              // Crear un elemento para cada foto
              const img = document.createElement("img");
              //solicitar a la api la foto
              img.src = `https://places.googleapis.com/v1/${photo.name}/media?maxHeightPx=400&maxWidthPx=400&key=${API_KEY}`;
            
              // Agregar la imagen al contenedor
              photoContainer.appendChild(img);
            });
          } else {
            console.log("No se encontraron fotos en la respuesta.");
          }
          //document.getElementById("output").innerText = JSON.stringify(data, null, 2);
        })
        .catch(error => {
          console.error("Error:", error);
          document.getElementById("output").innerText = `Error: ${error.message}`;
        });
    });
    
    
  </script>
</body>
</html>
